# Anomaly Detection Using ECOD and Autoattack

This project demonstrates anomaly detection using the **ECOD (Empirical Cumulative Distribution Function-based Outlier Detection)** method on adversarial data generated by **Autoattack**. The experiments were conducted using CIFAR10 and CIFAR100 datasets and evaluated for robustness and effectiveness.

---

## Project Structure

The repository includes three Jupyter Notebook files:

1. `Implementation_on_CIFAR10.ipynb` - Generates anomaly data for CIFAR10.
2. `Implementation_on_CIFAR100.ipynb` - Generates anomaly data for CIFAR100.
3. `AnomalyDetection.ipynb` - Performs anomaly detection using ECOD.

---

## How to Run the Project

Follow the steps below to run the project and generate results:

### 1. Generating Anomaly Data for CIFAR10

1. Run `Implementation_on_CIFAR10.ipynb` completely.
2. Navigate to the `aa-cifar-ResNet18` folder in your workspace. Inside, you'll find:
   - `AA_results_cifar10_L2`
   - `AA_results_cifar10_Linf`
3. From the `AA_results_cifar10_L2` folder, download:
   - `CIFAR10_L2_aa_standard_1_1000_eps_0.03137.pth` (Anomaly data file with a log file showing the results).
4. From the `AA_results_cifar10_Linf` folder, download:
   - `CIFAR10_Linf_aa_standard_1_1000_eps_0.03137.pth` (Anomaly data file with a log file showing the results).
5. In the `model-cifar10-ResNet18` folder, download:
   - `model-ResNet18-cifar10-best_epoch.pt` (Best-performing model for CIFAR10).

### 2. Generating Anomaly Data for CIFAR100

1. Run `Implementation_on_CIFAR100.ipynb` completely.
2. Navigate to the `aa-cifar-ResNet18` folder in your workspace. Inside, you'll find:
   - `AA_results_cifar100_L2`
   - `AA_results_cifar100_Linf`
3. From the `AA_results_cifar100_L2` folder, download:
   - `CIFAR100_L2_aa_standard_1_1000_eps_0.03137.pth` (Anomaly data file with a log file showing the results).
4. From the `AA_results_cifar100_Linf` folder, download:
   - `CIFAR100_Linf_aa_standard_1_1000_eps_0.03137.pth` (Anomaly data file with a log file showing the results).
5. In the `model-cifar100-ResNet18` folder, download:
   - `model-ResNet18-cifar100-best_epoch.pt` (Best-performing model for CIFAR100).

### 3. Performing Anomaly Detection

1. Open `AnomalyDetection.ipynb`.
2. Upload the following files into your directory:
   - `CIFAR10_L2_aa_standard_1_1000_eps_0.03137.pth`
   - `CIFAR10_Linf_aa_standard_1_1000_eps_0.03137.pth`
   - `model-ResNet18-cifar10-best_epoch.pt`
   - `CIFAR100_L2_aa_standard_1_1000_eps_0.03137.pth`
   - `CIFAR100_Linf_aa_standard_1_1000_eps_0.03137.pth`
   - `model-ResNet18-cifar100-best_epoch.pt`
3. Run `AnomalyDetection.ipynb` completely to generate all results.

---

## Results

The results of the anomaly detection process, including accuracy, recall, and precision metrics, are detailed in the output of `AnomalyDetection.ipynb`.
